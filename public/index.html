<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>Drupal API Client</title><meta name="description" content="Documentation for Drupal API Client"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/search.js" id="tsd-search-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os"</script><header class="tsd-page-toolbar">
<div class="tsd-toolbar-contents container">
<div class="table-cell" id="tsd-search" data-base=".">
<div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><path d="M15.7824 13.833L12.6666 10.7177C12.5259 10.5771 12.3353 10.499 12.1353 10.499H11.6259C12.4884 9.39596 13.001 8.00859 13.001 6.49937C13.001 2.90909 10.0914 0 6.50048 0C2.90959 0 0 2.90909 0 6.49937C0 10.0896 2.90959 12.9987 6.50048 12.9987C8.00996 12.9987 9.39756 12.4863 10.5008 11.6239V12.1332C10.5008 12.3332 10.5789 12.5238 10.7195 12.6644L13.8354 15.7797C14.1292 16.0734 14.6042 16.0734 14.8948 15.7797L15.7793 14.8954C16.0731 14.6017 16.0731 14.1267 15.7824 13.833ZM6.50048 10.499C4.29094 10.499 2.50018 8.71165 2.50018 6.49937C2.50018 4.29021 4.28781 2.49976 6.50048 2.49976C8.71001 2.49976 10.5008 4.28708 10.5008 6.49937C10.5008 8.70852 8.71314 10.499 6.50048 10.499Z" fill="var(--color-text)"></path></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div>
<div class="field">
<div id="tsd-toolbar-links"><a href="https://www.drupal.org/project/api_client">Project Page</a></div></div>
<ul class="results">
<li class="state loading">Preparing search index...</li>
<li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">Drupal API Client</a></div>
<div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><rect x="1" y="3" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="7" width="14" height="2" fill="var(--color-text)"></rect><rect x="1" y="11" width="14" height="2" fill="var(--color-text)"></rect></svg></a></div></div></header>
<div class="container container-main">
<div class="col-content">
<div class="tsd-page-title">
<h2>Drupal API Client</h2></div>
<div class="tsd-panel tsd-typography"><a id="md:drupal-api-client" class="tsd-anchor"></a><h1><a href="#md:drupal-api-client">Drupal API Client</a></h1><p>A core API client class that can be extended to support a variety of Drupal APIs, including:</p>
<ul>
<li>Drupal JSON:API Client</li>
</ul>
<a id="md:prerequisites" class="tsd-anchor"></a><h2><a href="#md:prerequisites">Prerequisites</a></h2><a id="md:setting-up-the-monorepo" class="tsd-anchor"></a><h3><a href="#md:setting-up-the-monorepo">Setting up the Monorepo</a></h3><p>To configure the monorepo for development, the following should be installed
locally:</p>
<ul>
<li><p>Node.js version 18 or current LTS <a href="https://pnpm.io/cli/env">pnpm env</a> is recommended to manage node versions.</p>
</li>
<li><p><a href="https://docs.npmjs.com/cli/v8/commands/npm">npm</a> version 9.x.x</p>
</li>
<li><p><a href="https://pnpm.io/installation">pnpm</a> version 8.x</p>
<p>We recommend using npm. Run the following command to install:</p>
<pre><code class="language-bash"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-3">-g</span><span class="hl-1"> </span><span class="hl-2">pnpm@8</span>
</code><button>Copy</button></pre>
</li>
</ul>
<a id="md:workspaces" class="tsd-anchor"></a><h3><a href="#md:workspaces">Workspaces</a></h3><p>There are two main workspaces in the monorepo, <code>packages</code>, and <code>examples</code></p>
<a id="md:packages" class="tsd-anchor"></a><h3><a href="#md:packages">Packages</a></h3><a id="md:api-client" class="tsd-anchor"></a><h4><a href="#md:api-client">api-client</a></h4><p>The <code>api-client</code> package includes the base <code>ApiClient</code> class which is meant to be extended by other classes that implement logic to make it easy to fetch data from Drupal.</p>
<a id="md:json-api-client" class="tsd-anchor"></a><h4><a href="#md:json-api-client">json-api-client</a></h4><p>The <code>json-api-client</code> package includes the <code>JsonApiClient</code> class which extends the <code>ApiClient</code>, and makes it easy to fetch data from Drupal&#39;s JSON:API without deep knowledge of it.</p>
<a id="md:examples" class="tsd-anchor"></a><h3><a href="#md:examples">Examples</a></h3><p>Examples show how the packages can be used in a variety of ways.</p>
<p>To configure examples to use a local Drupal environment (or override other environment variables) copy <code>.env.local.example</code> as <code>.env.local</code> in any of the example directories.</p>
<a id="md:json-api-client-example" class="tsd-anchor"></a><h4><a href="#md:json-api-client-example">json-api-client-example</a></h4><p>The json-api-client-example utilizes the JsonApiClient class to demonstrate how various configuration options can be employed for retrieving data.</p>
<a id="md:configure-the-monorepo" class="tsd-anchor"></a><h2><a href="#md:configure-the-monorepo">Configure the Monorepo</a></h2><p>To contribute to this project, follow the directions below.</p>
<ol>
<li>Fork this repo</li>
<li>Clone your fork to your local machine.</li>
<li>Install dependencies for all packages and starters using the following
command.<pre><code class="language-bash"><span class="hl-0">pnpm</span><span class="hl-1"> </span><span class="hl-2">install</span>
</code><button>Copy</button></pre>
</li>
</ol>
<a id="md:useful-scripts" class="tsd-anchor"></a><h3><a href="#md:useful-scripts">Useful Scripts</a></h3><p>There are several scripts you can use in the monorepo.</p>
<ul>
<li><p>To see all available scripts:</p>
<pre><code class="language-bash"><span class="hl-0">pnpm</span><span class="hl-1"> </span><span class="hl-2">run</span>
</code><button>Copy</button></pre>
</li>
<li><p>Test all projects in the monorepo that have a test script:</p>
<pre><code class="language-bash"><span class="hl-0">pnpm</span><span class="hl-1"> </span><span class="hl-2">test</span>
</code><button>Copy</button></pre>
</li>
<li><p>Build all packages in the monorepo:</p>
<pre><code class="language-bash"><span class="hl-0">pnpm</span><span class="hl-1"> </span><span class="hl-2">build:packages</span>
</code><button>Copy</button></pre>
</li>
<li><p>Start the <code>json-api-client</code> example in development mode:</p>
<pre><code class="language-bash"><span class="hl-0">pnpm</span><span class="hl-1"> </span><span class="hl-2">dev:json-api-client</span>
</code><button>Copy</button></pre>
</li>
<li><p>Format code using Prettier:</p>
<pre><code class="language-bash"><span class="hl-0">pnpm</span><span class="hl-1"> </span><span class="hl-2">prettier:fix</span>
</code><button>Copy</button></pre>
</li>
<li><p>Build the examples</p>
<pre><code class="language-bash"><span class="hl-0">pnpm</span><span class="hl-1"> </span><span class="hl-2">build:examples</span>
</code><button>Copy</button></pre>
</li>
<li><p>Run the jso-api-client-example</p>
<pre><code class="language-bash"><span class="hl-0">pnpm</span><span class="hl-1"> </span><span class="hl-2">serve:json-api-client-example</span>
</code><button>Copy</button></pre>
</li>
<li><p>Run commands in a targeted project, folder, or workspace, using the
<a href="https://pnpm.io/filtering"><code>pnpm</code> filter flag</a>.</p>
<p>For example, to build the api-client (filter by namespace):</p>
<pre><code class="language-bash"><span class="hl-0">pnpm</span><span class="hl-1"> </span><span class="hl-3">--filter</span><span class="hl-1"> </span><span class="hl-2">api-client</span><span class="hl-1"> </span><span class="hl-2">build</span>
</code><button>Copy</button></pre>
</li>
</ul>
<p>If you need to run a command in a specific project, use the alias in the ROOT
<code>package.json</code> scripts (<code>pnpm run</code> to see the full list in your terminal), or
use a filter. Please do not <code>cd</code> into the project directory and use <code>npm</code> or
<code>yarn</code>.</p>
<a id="md:coding-standards" class="tsd-anchor"></a><h3><a href="#md:coding-standards">Coding Standards</a></h3><p>This project is being developed with a slight variation of the <a href="https://www.drupal.org/docs/develop/standards/javascript/javascript-coding-standards">Drupal JavaScript coding standards</a> in order to have a set of guidelines that work well with TypeScript. Since the AirBnb style guide does not officially have TypeScript support, we are using the <a href="https://www.npmjs.com/package/eslint-config-airbnb-typescript">eslint-config-airbnb-typescript</a> package to add Typescript compatibility. We are also using <a href="https://tsdoc.org/">TSDoc</a> instead of <a href="https://jsdoc.app/">JSDoc3</a> to standardize our doc comments.</p>
<a id="md:eslint-config-airbnb-typescript-overrides" class="tsd-anchor"></a><h4><a href="#md:eslint-config-airbnb-typescript-overrides"><code>eslint-config-airbnb-typescript</code> Overrides</a></h4><ul>
<li>Use named exports instead of default exports</li>
</ul>
<a id="md:editor-integration" class="tsd-anchor"></a><h3><a href="#md:editor-integration">Editor Integration</a></h3><a id="md:vscode" class="tsd-anchor"></a><h4><a href="#md:vscode">VSCode</a></h4><p>We recommend using <a href="https://code.visualstudio.com/">VSCode</a> as your editor. You will be prompted to install the recommended extensions when you open the project in VSCode. Settings are also included in this project to format code on save using Prettier.</p>
<a id="md:versions-and-releases" class="tsd-anchor"></a><h2><a href="#md:versions-and-releases">Versions and Releases</a></h2><a id="md:generating-a-changeset" class="tsd-anchor"></a><h3><a href="#md:generating-a-changeset">Generating a Changeset</a></h3><p>To generate a new changeset, run <code>pnpm changeset</code> in the root of the repository.
The generated Markdown files in the <code>.changeset</code> directory should be committed
to the repository.</p>
<a id="md:creating-and-publishing-new-versions" class="tsd-anchor"></a><h3><a href="#md:creating-and-publishing-new-versions">Creating and Publishing New Versions</a></h3><p>Releases are automated using the <a href="https://www.npmjs.com/package/changesets-gitlab">changesets-gitlab</a> package. To publish a new release:</p>
<ul>
<li>Create a merge request of <code>canary</code> against <code>main</code>. Do not squash commits to main as this will cause later conflicts.</li>
<li>Merge the MR. When code is merged to main and changesets are detected, the release job will run. This will create a new &#39;Version Packages&#39; merge request.</li>
<li>Review the &#39;Version Packages&#39; MR. Merge if this contains the expected package versions and changes. When merged this will publish any updated packages to NPM.</li>
<li>Create a new MR of <code>main</code> against <code>canary</code>. Merge this to bring <code>canary</code> up to date with the latest package versions and changesets.</li>
</ul>
<a id="md:developing-with-a-local-drupal-instance" class="tsd-anchor"></a><h2><a href="#md:developing-with-a-local-drupal-instance">Developing with a Local Drupal Instance</a></h2><p>The example projects included in <code>/examples</code> use a hosted Drupal environment by default. In cases where you need to modify data or the CMS install itself, using a local Drupal environment can be helpful.</p>
<a id="md:prerequisites-1" class="tsd-anchor"></a><h3><a href="#md:prerequisites-1">Prerequisites</a></h3><ul>
<li><a href="https://ddev.readthedocs.io/en/stable/users/install/docker-installation/">Install a Docker provider</a></li>
<li><a href="https://ddev.readthedocs.io/en/stable/users/install/ddev-installation/">Install DDEV</a></li>
<li><a href="https://ddev.readthedocs.io/en/stable/users/usage/troubleshooting/#method-1-stop-the-conflicting-application">Stop other conflicting Docker applications</a></li>
</ul>
<a id="md:installing-drupal" class="tsd-anchor"></a><h3><a href="#md:installing-drupal">Installing Drupal</a></h3><p>From the root of the repository, run:</p>
<p><code>pnpm ddev:init</code></p>
<p>This will create a new Drupal instance in <code>/drupal</code>, build your DDEV instance, install Drupal with Umami demo data, and configure features used by the API Client. The <code>/drupal</code> directory is ignored by version control.</p>
<p>Drupal will be available at:</p>
<p><code>https://drupal.ddev.site</code></p>
<p>and the following API endpoints will be active:</p>
<p><code>https://drupal.ddev.site/jsonapi</code>
<code>https://drupal.ddev.site/router/translate-path</code></p>
<p>You will be able to interact with your DDEV instance <a href="https://ddev.readthedocs.io/en/stable/users/usage/cli/">using the <code>ddev</code> command</a> inside of the <code>/drupal</code> directory. Drush will also be installed and available via <code>ddev drush</code>.</p>
<a id="md:removing-drupal" class="tsd-anchor"></a><h3><a href="#md:removing-drupal">Removing Drupal</a></h3><p>From the root of the repository, run:</p>
<p><code>pnpm ddev:destroy</code></p>
<p>This will delete your DDEV instance and remove your Drupal codebase.</p>
<a id="md:adding-a-new-package" class="tsd-anchor"></a><h2><a href="#md:adding-a-new-package">Adding a new package</a></h2><p>Ymmv, but these are the steps I followed when creating a new package that extends api-client. I don&#39;t expect us to be doing this frequently, but if that proves wrong we could create a scaffolder for this.</p>
<ul>
<li>Create a new subdirectory in &#39;packages&#39;</li>
<li>Copy package.json from api-client into the new package directory.</li>
<li>Update name, version and description in package.json. Edit dependencies if necessary.</li>
<li>Add <code>&quot;@drupal-api-client/api-client&quot;: &quot;workspace:*&quot;</code> as a dependency</li>
<li>run <code>pnpm i</code> at the root of the repository.</li>
<li>Create <code>README.md</code> in the new package directory.</li>
<li>Copy the following files from <code>api-client</code> to the new package:<ul>
<li>.eslintrc</li>
<li>tsconfig.json</li>
<li>tsconfig.typedoc.json</li>
<li>tsup.config.ts</li>
<li>vite.config.mts</li>
</ul>
</li>
<li>Create an <code>src</code> subdirectory with:<ul>
<li>a typescript file named after your new class.</li>
<li>A types.ts file.</li>
<li>an index.ts file - this should export your newly created class and any types. You can model this after index.ts in the api-client package.</li>
</ul>
</li>
<li>It now should be possible to build by running <code>pnpm build</code> in the new package directory.</li>
<li>Create tests<ul>
<li>Add tests directory with at least one test.ts file.</li>
<li>Update the test object in vite.config.mts if tests do not yet use mocks or a setup file.</li>
</ul>
</li>
<li>Scaffold example<ul>
<li>Create a new subdirectory in /examples</li>
<li>Excluding CHANGELOG.md, /dist, and /node_modules, copy the files from another example.</li>
<li>Remove and add dependencies from package.json as needed.</li>
<li>run <code>pnpm i</code> at the root of the repository.</li>
<li>Update README.md.</li>
<li>Add a src/main.ts file with your example.</li>
<li>It now should be possible to running <code>pnpm dev</code> and <code>pnpm build</code> in the new example directory.</li>
</ul>
</li>
</ul>
</div></div>
<div class="col-sidebar">
<div class="page-menu">
<div class="tsd-navigation settings">
<details class="tsd-index-accordion"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><path d="M4.93896 8.531L12 15.591L19.061 8.531L16.939 6.409L12 11.349L7.06098 6.409L4.93896 8.531Z" fill="var(--color-text)" id="icon-chevronDown"></path></svg>Settings</h3></summary>
<div class="tsd-accordion-details">
<div class="tsd-filter-visibility">
<h4 class="uppercase">Member Visibility</h4><form>
<ul id="tsd-filter-options">
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li>
<li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div>
<div class="tsd-theme-toggle">
<h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div>
<details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary">
<h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="#icon-chevronDown"></use></svg>On This Page</h3></summary>
<div class="tsd-accordion-details">
<ul>
<li>
<ul>
<li><a href="#md:drupal-api-client"><span>Drupal API <wbr/>Client</span></a></li>
<li>
<ul>
<li><a href="#md:prerequisites"><span>Prerequisites</span></a></li>
<li>
<ul>
<li><a href="#md:setting-up-the-monorepo"><span>Setting up the <wbr/>Monorepo</span></a></li>
<li><a href="#md:workspaces"><span>Workspaces</span></a></li>
<li><a href="#md:packages"><span>Packages</span></a></li>
<li>
<ul>
<li><a href="#md:api-client"><span>api-<wbr/>client</span></a></li>
<li><a href="#md:json-api-client"><span>json-<wbr/>api-<wbr/>client</span></a></li></ul></li>
<li><a href="#md:examples"><span>Examples</span></a></li>
<li>
<ul>
<li><a href="#md:json-api-client-example"><span>json-<wbr/>api-<wbr/>client-<wbr/>example</span></a></li></ul></li></ul></li>
<li><a href="#md:configure-the-monorepo"><span>Configure the <wbr/>Monorepo</span></a></li>
<li>
<ul>
<li><a href="#md:useful-scripts"><span>Useful <wbr/>Scripts</span></a></li>
<li><a href="#md:coding-standards"><span>Coding <wbr/>Standards</span></a></li>
<li>
<ul>
<li><a href="#md:eslint-config-airbnb-typescript-overrides"><span>eslint-<wbr/>config-<wbr/>airbnb-<wbr/>typescript <wbr/>Overrides</span></a></li></ul></li>
<li><a href="#md:editor-integration"><span>Editor <wbr/>Integration</span></a></li>
<li>
<ul>
<li><a href="#md:vscode"><span>VSCode</span></a></li></ul></li></ul></li>
<li><a href="#md:versions-and-releases"><span>Versions and <wbr/>Releases</span></a></li>
<li>
<ul>
<li><a href="#md:generating-a-changeset"><span>Generating a <wbr/>Changeset</span></a></li>
<li><a href="#md:creating-and-publishing-new-versions"><span>Creating and <wbr/>Publishing <wbr/>New <wbr/>Versions</span></a></li></ul></li>
<li><a href="#md:developing-with-a-local-drupal-instance"><span>Developing with a <wbr/>Local <wbr/>Drupal <wbr/>Instance</span></a></li>
<li>
<ul>
<li><a href="#md:prerequisites-1"><span>Prerequisites</span></a></li>
<li><a href="#md:installing-drupal"><span>Installing <wbr/>Drupal</span></a></li>
<li><a href="#md:removing-drupal"><span>Removing <wbr/>Drupal</span></a></li></ul></li>
<li><a href="#md:adding-a-new-package"><span>Adding a new package</span></a></li></ul></li></ul></li></ul></div></details></div>
<div class="site-menu">
<nav class="tsd-navigation"><a href="index.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><g id="icon-4"><rect fill="var(--color-icon-background)" stroke="var(--color-ts-namespace)" stroke-width="1.5" x="1" y="1" width="22" height="22" rx="6"></rect><path d="M9.33 16V7.24H10.77L13.446 14.74C13.43 14.54 13.41 14.296 13.386 14.008C13.37 13.712 13.354 13.404 13.338 13.084C13.33 12.756 13.326 12.448 13.326 12.16V7.24H14.37V16H12.93L10.266 8.5C10.282 8.692 10.298 8.936 10.314 9.232C10.33 9.52 10.342 9.828 10.35 10.156C10.366 10.476 10.374 10.784 10.374 11.08V16H9.33Z" fill="var(--color-text)"></path></g></svg><span>Drupal API <wbr/>Client</span></a>
<ul class="tsd-small-nested-navigation">
<li><a href="modules/_drupal_api_client_api_client.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@drupal-<wbr/>api-<wbr/>client/api-<wbr/>client</span></a></li>
<li><a href="modules/_drupal_api_client_decoupled_router_client.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@drupal-<wbr/>api-<wbr/>client/decoupled-<wbr/>router-<wbr/>client</span></a></li>
<li><a href="modules/_drupal_api_client_json_api_client.html"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="#icon-4"></use></svg><span>@drupal-<wbr/>api-<wbr/>client/json-<wbr/>api-<wbr/>client</span></a></li></ul></nav></div></div></div>
<div class="tsd-generator">
<p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div>
<div class="overlay"></div></body></html>